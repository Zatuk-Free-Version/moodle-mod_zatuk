{"version":3,"file":"upload.min.js","sources":["../src/upload.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * This file is haveing the functionality for video upload.\n *\n * @copyright  2023 Moodle India\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport ModalForm from 'core_form/modalform';\nimport {get_string as getString} from 'core/str';\nimport messagemodal from 'mod_zatuk/messagemodal';\nconst Selectors = {\n    actions: {\n        uploadvideo: '[data-action=\"uploadvideo\"]',\n    },\n};\nlet MessageModal = new messagemodal();\nexport const init = () => {\n    document.addEventListener('click', function(e) {\n        let uploadvideo = e.target.closest(Selectors.actions. uploadvideo);\n        if (uploadvideo) {\n            e.stopImmediatePropagation();\n            const zatukrepositorystatus = uploadvideo.getAttribute('data-zatukrepoenabled');\n            const zatukid = uploadvideo.getAttribute('data-id');\n            if (zatukrepositorystatus == 1) {\n                const title = uploadvideo.getAttribute('data-id') ?\n                    getString('uploadvideo', 'mod_zatuk', uploadvideo.getAttribute('data-name')) :\n                    getString('uploadvideo', 'mod_zatuk');\n                const form = new ModalForm({\n                    formClass: 'mod_zatuk\\\\form\\\\upload',\n                    args: {id: zatukid},\n                    modalConfig: {title},\n                    returnFocus: uploadvideo,\n                });\n                form.addEventListener(form.events.FORM_SUBMITTED, () => window.location.reload());\n                form.addEventListener(form.events.FORM_SUBMITTED, (event) => {\n                    event.preventDefault();\n                    if (zatukid) {\n                        var messageString = getString('videoupdated' ,'mod_zatuk');\n                    } else {\n                        var messageString = getString('videouploaded' ,'mod_zatuk');\n                    }\n                    messageString.then((str) => {\n                      MessageModal.confirmbox(getString('finalzatuksmessage','mod_zatuk',str));\n                    });\n                    setTimeout(function() {\n                        window.location.reload();\n                    },3500);\n                });\n                form.show();\n\n            } else {\n                getString('enablezatuk' ,'mod_zatuk').then((str) => {\n                    MessageModal.confirmbox(getString('finalzatuksmessage','mod_zatuk',str));\n                });\n            }\n        }\n    });\n};\n"],"names":["Selectors","uploadvideo","MessageModal","messagemodal","document","addEventListener","e","target","closest","stopImmediatePropagation","zatukrepositorystatus","getAttribute","zatukid","title","form","ModalForm","formClass","args","id","modalConfig","returnFocus","events","FORM_SUBMITTED","window","location","reload","event","preventDefault","messageString","then","str","confirmbox","setTimeout","show"],"mappings":";;;;;;0LAwBMA,kBACO,CACLC,YAAa,mCAGjBC,aAAe,IAAIC,oCACH,KAChBC,SAASC,iBAAiB,SAAS,SAASC,OACpCL,YAAcK,EAAEC,OAAOC,QAAQR,kBAAmBC,gBAClDA,YAAa,CACbK,EAAEG,iCACIC,sBAAwBT,YAAYU,aAAa,yBACjDC,QAAUX,YAAYU,aAAa,cACZ,GAAzBD,sBAA4B,OACtBG,MAAQZ,YAAYU,aAAa,YACnC,mBAAU,cAAe,YAAaV,YAAYU,aAAa,eAC/D,mBAAU,cAAe,aACvBG,KAAO,IAAIC,mBAAU,CACvBC,UAAW,0BACXC,KAAM,CAACC,GAAIN,SACXO,YAAa,CAACN,MAAAA,OACdO,YAAanB,cAEjBa,KAAKT,iBAAiBS,KAAKO,OAAOC,gBAAgB,IAAMC,OAAOC,SAASC,WACxEX,KAAKT,iBAAiBS,KAAKO,OAAOC,gBAAiBI,WAC/CA,MAAMC,iBACFf,YACIgB,eAAgB,mBAAU,eAAgB,kBAE1CA,eAAgB,mBAAU,gBAAiB,aAEnDA,cAAcC,MAAMC,MAClB5B,aAAa6B,YAAW,mBAAU,qBAAqB,YAAYD,SAErEE,YAAW,WACPT,OAAOC,SAASC,WAClB,SAENX,KAAKmB,+BAGK,cAAe,aAAaJ,MAAMC,MACxC5B,aAAa6B,YAAW,mBAAU,qBAAqB,YAAYD"}