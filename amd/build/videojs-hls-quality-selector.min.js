var global,factory;global=window,factory=function(videojs){videojs=videojs&&videojs.hasOwnProperty("default")?videojs.default:videojs;var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},classCallCheck=(function(){function AwaitValue(value){this.value=value}function AsyncGenerator(gen){var front,back;function resume(key,arg){try{var result=gen[key](arg),value=result.value;value instanceof AwaitValue?Promise.resolve(value.value).then((function(arg){resume("next",arg)}),(function(arg){resume("throw",arg)})):settle(result.done?"return":"normal",result.value)}catch(err){settle("throw",err)}}function settle(type,value){switch(type){case"return":front.resolve({value:value,done:!0});break;case"throw":front.reject(value);break;default:front.resolve({value:value,done:!1})}(front=front.next)?resume(front.key,front.arg):back=null}this._invoke=function(key,arg){return new Promise((function(resolve,reject){var request={key:key,arg:arg,resolve:resolve,reject:reject,next:null};back?back=back.next=request:(front=back=request,resume(key,arg))}))},"function"!=typeof gen.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(AsyncGenerator.prototype[Symbol.asyncIterator]=function(){return this}),AsyncGenerator.prototype.next=function(arg){return this._invoke("next",arg)},AsyncGenerator.prototype.throw=function(arg){return this._invoke("throw",arg)},AsyncGenerator.prototype.return=function(arg){return this._invoke("return",arg)}}(),function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}),inherits=function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)},possibleConstructorReturn=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call},VideoJsButtonClass=videojs.getComponent("MenuButton"),VideoJsMenuClass=videojs.getComponent("Menu"),VideoJsComponent=videojs.getComponent("Component"),Dom=videojs.dom,ConcreteButton=function(_VideoJsButtonClass){function ConcreteButton(player){return classCallCheck(this,ConcreteButton),possibleConstructorReturn(this,_VideoJsButtonClass.call(this,player,{title:player.localize("Quality"),name:"QualityButton"}))}return inherits(ConcreteButton,_VideoJsButtonClass),ConcreteButton.prototype.createItems=function(){return[]},ConcreteButton.prototype.createMenu=function(){var string,menu=new VideoJsMenuClass(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var titleEl=Dom.createEl("li",{className:"vjs-menu-title",innerHTML:(string=this.options_.title,"string"!=typeof string?string:string.charAt(0).toUpperCase()+string.slice(1)),tabIndex:-1}),titleComponent=new VideoJsComponent(this.player_,{el:titleEl});this.hideThreshold_+=1,menu.addItem(titleComponent)}if(this.items=this.createItems(),this.items)for(var i=0;i<this.items.length;i++)menu.addItem(this.items[i]);return menu},ConcreteButton}(VideoJsButtonClass),ConcreteMenuItem=function(_VideoJsMenuItemClass){function ConcreteMenuItem(player,item,qualityButton,plugin){classCallCheck(this,ConcreteMenuItem);var _this=possibleConstructorReturn(this,_VideoJsMenuItemClass.call(this,player,{label:item.label,selectable:!0,selected:item.selected||!1}));return _this.item=item,_this.qualityButton=qualityButton,_this.plugin=plugin,_this}return inherits(ConcreteMenuItem,_VideoJsMenuItemClass),ConcreteMenuItem.prototype.handleClick=function(){for(var i=0;i<this.qualityButton.items.length;++i)this.qualityButton.items[i].selected(!1);this.plugin.setQuality(this.item.value),this.selected(!0)},ConcreteMenuItem}(videojs.getComponent("MenuItem")),defaults={},registerPlugin=videojs.registerPlugin||videojs.plugin,HlsQualitySelectorPlugin=function(){function HlsQualitySelectorPlugin(player,options){classCallCheck(this,HlsQualitySelectorPlugin),this.player=player,this.config=options,this.player.qualityLevels&&this.getHls()&&(this.createQualityButton(),this.bindPlayerEvents())}return HlsQualitySelectorPlugin.prototype.getHls=function(){return this.player.tech({IWillNotUseThisInPlugins:!0}).hls},HlsQualitySelectorPlugin.prototype.bindPlayerEvents=function(){this.player.qualityLevels().on("addqualitylevel",this.onAddQualityLevel.bind(this))},HlsQualitySelectorPlugin.prototype.createQualityButton=function(){var player=this.player;this._qualityButton=new ConcreteButton(player);var placementIndex=player.controlBar.children().length-2,concreteButtonInstance=player.controlBar.addChild(this._qualityButton,{componentClass:"qualitySelector"},this.config.placementIndex||placementIndex);if(concreteButtonInstance.addClass("vjs-quality-selector"),this.config.displayCurrentQuality)this.setButtonInnerText("auto");else{var icon=" "+(this.config.vjsIconClass||"vjs-icon-hd");concreteButtonInstance.menuButton_.$(".vjs-icon-placeholder").className+=icon}concreteButtonInstance.removeClass("vjs-hidden")},HlsQualitySelectorPlugin.prototype.setButtonInnerText=function(text){this._qualityButton.menuButton_.$(".vjs-icon-placeholder").innerHTML=text},HlsQualitySelectorPlugin.prototype.getQualityMenuItem=function(item){var player=this.player;return new ConcreteMenuItem(player,item,this._qualityButton,this)},HlsQualitySelectorPlugin.prototype.onAddQualityLevel=function(){for(var _this=this,player=this.player,levels=player.qualityLevels().levels_||[],levelItems=[],_loop=function(i){if(!levelItems.filter((function(_existingItem){return _existingItem.item&&_existingItem.item.value===levels[i].height})).length){var levelItem=_this.getQualityMenuItem.call(_this,{label:levels[i].height+"p",value:levels[i].height});levelItems.push(levelItem)}},i=0;i<levels.length;++i)_loop(i);levelItems.sort((function(current,next){return"object"!==(void 0===current?"undefined":_typeof(current))||"object"!==(void 0===next?"undefined":_typeof(next))||current.item.value<next.item.value?-1:current.item.value>next.item.value?1:0})),levelItems.push(this.getQualityMenuItem.call(this,{label:player.localize("Auto"),value:"auto",selected:!0})),this._qualityButton&&(this._qualityButton.createItems=function(){return levelItems},this._qualityButton.update())},HlsQualitySelectorPlugin.prototype.setQuality=function(height){var qualityList=this.player.qualityLevels();this._currentQuality=height,this.config.displayCurrentQuality&&this.setButtonInnerText("auto"===height?height:height+"p");for(var i=0;i<qualityList.length;++i){var quality=qualityList[i];quality.enabled=quality.height===height||"auto"===height}this._qualityButton.unpressButton()},HlsQualitySelectorPlugin.prototype.getCurrentQuality=function(){return this._currentQuality||"auto"},HlsQualitySelectorPlugin}(),hlsQualitySelector=function(options){var _this2=this;this.ready((function(){!function(player,options){player.addClass("vjs-hls-quality-selector"),player.hlsQualitySelector=new HlsQualitySelectorPlugin(player,options)}(_this2,videojs.obj.merge(defaults,options))}))};return registerPlugin("hlsQualitySelector",hlsQualitySelector),hlsQualitySelector.VERSION="1.1.4",hlsQualitySelector},"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("media_videojs/video-lazy")):"function"==typeof define&&define.amd?define("mod_zatuk/videojs-hls-quality-selector",["media_videojs/video-lazy"],factory):global.videojsHlsQualitySelector=factory(global.videojs);

//# sourceMappingURL=videojs-hls-quality-selector.min.js.map